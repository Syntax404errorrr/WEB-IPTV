<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>UM IPTV - Player</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.10/dist/hls.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script> 
  <link rel="icon" href="images/logo.png" type="image/x-icon">
    <style>
    /* Sidebar smooth slide transition */
    #channelSidebar {
      transition: transform 0.3s ease-in-out;
      will-change: transform;
    }
    /* Overlay fade transition */
    #overlay {
      transition: opacity 0.3s ease-in-out;
      will-change: opacity;
    }
    /* Hidden but allows transition */
    #overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }
    /* Visible overlay */
    #overlay.visible {
      opacity: 1;
      pointer-events: auto;
    }
    /* Blur effect for main content and footer */
    .blurred {
      filter: blur(6px);
      transition: filter 0.3s ease-in-out;
    }
  </style>
</head>
<body class="bg-[#111] text-white flex flex-col min-h-screen font-sans relative overflow-x-hidden">

  <!--Header-->
  <header class="bg-[#1a1a1a] shadow-md p-4 flex justify-between items-center z-40 relative">
    <div class="inline-flex items-center gap-3">
      <img src="images/logo.png" alt="Logo" class="h-7 w-7 sm:h-6 sm:w-6" />
      <h1 class="text-xl sm:text-lg bg-gradient-to-r from-[#00c6ff] to-[#0072ff] bg-clip-text text-transparent font-semibold">
        UM IPTV
      </h1>
    </div>

    <!--Toggle-->
    <button id="sidebarToggle" aria-expanded="false" aria-controls="channelSidebar"
      class="text-white text-2xl focus:outline-none" aria-label="Toggle sidebar">
      <i class="fas fa-bars" id="toggleIcon"></i>
    </button>
  </header>

  <!--Sidebar-->
  <aside id="channelSidebar"
    class="fixed top-0 left-0 h-full w-72 max-w-full bg-[#1f1f1f]/90 border-r border-[#222] backdrop-blur-md p-4 overflow-y-auto shadow-lg transform -translate-x-full z-50">

    <!--Close-->
    <button id="closeSidebar" class="text-white mb-4 text-right w-full focus:outline-none" aria-label="Close sidebar">
      <i class="fas fa-times text-xl hover:text-[#00c6ff] transition"></i>
    </button>

    <div class="mb-4">
      <input
        type="text"
        id="search"
        placeholder="Search channels..."
        class="w-full p-2 text-sm rounded-md bg-[#323232b3] text-white placeholder-white focus:outline-none backdrop-blur-sm"
      />
    </div>
    <h3 class="text-[#00c6ff] text-center text-sm font-semibold mb-4">Channel Lists</h3>
    <div id="channel-items" class="space-y-2">
      <!--Channels-->
      <div
        class="channel px-3 py-2 rounded-md hover:bg-[#333] hover:text-[#00c6ff] cursor-pointer text-[#ddd] transition">
        Channel 1
      </div>
      <div
        class="channel px-3 py-2 rounded-md hover:bg-[#333] hover:text-[#00c6ff] cursor-pointer text-[#ddd] transition">
        Channel 2
      </div>
      <div
        class="channel px-3 py-2 rounded-md hover:bg-[#333] hover:text-[#00c6ff] cursor-pointer text-[#ddd] transition">
        Channel 3
      </div>
    </div>
  </aside>

  <!--Overlay-->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-60 hidden z-40"></div>

  <!--Main Content blur-->
  <div id="contentWrapper" class="flex-1 flex flex-col relative z-10 transition-filter duration-300 ease-in-out">
    <!--Main-->
    <main class="flex-1 flex items-center justify-center p-4 bg-black/60 backdrop-blur-md">
      <video id="video" controls autoplay
        class="w-full max-w-4xl rounded-xl shadow-xl max-h-[70vh] sm:max-h-[60vh]"></video>
    </main>

    <!--Footer-->
    <footer
      class="bg-[#111]/30 backdrop-blur-lg shadow-inner text-center p-2 text-sm">
      <div class="flex justify-center space-x-4 mb-1 text-lg">
        <a href="https://www.facebook.com/share/g/19nyh6LRbE/" target="_blank"
          class="hover:text-[#00c6ff] transition-colors">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://youtube.com/@unknownmods_426?si=008ZsCm-20Uq8kst" target="_blank"
          class="hover:text-[#00c6ff] transition-colors">
          <i class="fab fa-youtube"></i>
        </a>
        <a href="https://t.me/UnknownMods_426" target="_blank"
          class="hover:text-[#00c6ff] transition-colors">
          <i class="fab fa-telegram-plane"></i>
        </a>
      </div>
      <div class="text-xs text-gray-400">
        &copy; 2025 UM IPTV
      </div>
    </footer>
  </div>

  <script>

    const sidebarToggle = document.getElementById('sidebarToggle');
    const channelSidebar = document.getElementById('channelSidebar');
    const toggleIcon = document.getElementById('toggleIcon');
    const closeSidebar = document.getElementById('closeSidebar');
    const overlay = document.getElementById('overlay');
    const contentWrapper = document.getElementById('contentWrapper');

    function openSidebar() {
      channelSidebar.classList.remove('-translate-x-full');
      overlay.classList.remove('hidden');
      overlay.classList.remove('opacity-0');
      overlay.classList.add('visible', 'opacity-100');
      sidebarToggle.setAttribute('aria-expanded', 'true');
      sidebarToggle.style.visibility = 'hidden';
      contentWrapper.classList.add('blurred');
    }

    function closeSidebarFunc() {
      channelSidebar.classList.add('-translate-x-full');
      overlay.classList.remove('opacity-100', 'visible');
      overlay.classList.add('opacity-0');
      setTimeout(() => {
        overlay.classList.add('hidden');
      }, 300);
      sidebarToggle.setAttribute('aria-expanded', 'false');
      sidebarToggle.style.visibility = 'visible';
      toggleIcon.classList.remove('fa-times');
      toggleIcon.classList.add('fa-bars');
      contentWrapper.classList.remove('blurred');
    }

    sidebarToggle.addEventListener('click', () => {
      if (channelSidebar.classList.contains('-translate-x-full')) {
        openSidebar();
      } else {
        closeSidebarFunc();
      }
    });

    closeSidebar.addEventListener('click', closeSidebarFunc);

    overlay.addEventListener('click', closeSidebarFunc);

    // Close sidebar with ESC key
    document.addEventListener('keydown', (e) => {
      if (e.key === "Escape" && !channelSidebar.classList.contains('-translate-x-full')) {
        closeSidebarFunc();
      }
    });

    const m3u8Url = "https://raw.githubusercontent.com/Syntax404errorrr/IPTVPH/main/premium.m3u8";
    const video = document.getElementById("video");
    const searchInput = document.getElementById("search");
    const channelItems = document.getElementById("channel-items");
    let allChannels = [];

    function parseM3U8(m3u8Text) {
      const lines = m3u8Text.split("\n");
      const channels = [];
      let current = {};

      for (let i = 0; i < lines.length; i++) {
        const line = lines[i].trim();
        if (line.startsWith("#EXTINF")) {
          const titleMatch = line.match(/,(.+)/);
          current.title = titleMatch ? titleMatch[1] : "Untitled";
        } else if (line && !line.startsWith("#")) {
          current.url = line;
          channels.push({ ...current });
          current = {};
        }
      }

      return channels;
    }

    function loadChannels(channels) {
      const filtered = channels.filter(c =>
        c.title && c.title.toLowerCase().includes(searchInput.value.toLowerCase())
      );
      channelItems.innerHTML = "";

      filtered.forEach(channel => {
        const div = document.createElement("div");
        div.className = "channel";
        div.textContent = channel.title;
        div.onclick = () => playStream(channel.url);
        channelItems.appendChild(div);
      });
    }

    function playStream(url) {
      if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(video);
      } else if (video.canPlayType("application/vnd.apple.mpegurl")) {
        video.src = url;
      }
    }

    searchInput.addEventListener("input", () => loadChannels(allChannels));

    fetch(m3u8Url)
      .then(response => response.text())
      .then(data => {
        allChannels = parseM3U8(data);
        if (allChannels.length > 0) {
          playStream(allChannels[0].url);
          loadChannels(allChannels);
        } else {
          channelItems.innerHTML = "<div>No channels found.</div>";
        }
      })
      .catch(err => {
        console.error("Failed to load M3U8:", err);
        channelItems.innerHTML = "<div>Failed to load channels.</div>";
      });
  </script>
</body>
</html>
